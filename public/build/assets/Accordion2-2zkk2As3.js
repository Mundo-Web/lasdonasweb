import{j as a}from"./Example-zgwdEd5i.js";import{r as u}from"./useOutsideClick-TT1qJ6UJ.js";import{a as h}from"./axios-_sX4vCAy.js";import{s as m}from"./storage-zp2nPsZU.js";const x=async l=>{try{const n=await h.post("/api/products/addComplemento",{id:l});if(n.status===200){const{data:s}=n.data;let o=s.map(e=>{var c;const r={id:e.id,producto:e.producto,precio:e.descuento>0?e.descuento:e.precio,imagen:((c=e.images.filter(p=>p.caratula===1)[0])==null?void 0:c.name_imagen)??"/images/img/noimagen.jpg",cantidad:1,sku:e.sku,tipo:"Complemento",fecha:"",horario:"",extract:e.extract};return e.tipo_servicio=="complemento"&&e.puntos_complemento>0&&(r.points=e.puntos_complemento),r}),t=m.Local.get("carrito")??[];t.some(e=>e.id===o[0].id)?t=t.map(e=>e.id===o[0].id?{...e,cantidad:e.cantidad+Number(o[0].cantidad)}:e):t=[...t,o[0]],m.Local.set("carrito",t);const i=$("#gift-icon");i.addClass("send-to-cart"),setTimeout(()=>{i.removeClass("send-to-cart"),i.removeAttr("style"),limpiarHTML(),PintarCarrito(),$(cartButton).addClass("shake"),setTimeout(function(){$(cartButton).removeClass("shake")},1e3)},1e3)}}catch(n){console.error(n),Swal.fire({icon:"error",title:"Error",text:"Hubo un error al agregar el pedido. Por favor, intÃ©ntelo de nuevo."})}},f=({id:l,setDetallePedido:n})=>{const[s,o]=u.useState([]),[t,d]=u.useState(!0);if(u.useEffect(()=>{(async()=>{try{const r=await h.post("/buscaSubComplementosDetalle",{id:l});o(r.data.productos),d(!1)}catch(r){console.error("Error fetching data:",r),d(!1)}})()},[l]),t)return a.jsx("div",{children:"Loading..."});const i=e=>{console.log(e),(Local.get("carrito")??[]).length>0?(console.log("entra porque tiene algo "),x(e)):n(c=>c.complementos.findIndex(g=>g===e)===-1?{...c,complementos:[...c.complementos,e]}:{...c,complementos:c.complementos.filter(g=>g!==e)})};return a.jsx("div",{className:"grid w-full gap-4 grid-cols-1 md:grid-cols-4 mt-6",children:s.map(e=>a.jsxs("div",{className:"m-auto",children:[a.jsx("label",{htmlFor:`react-option-${e.id}`,className:"inline-flex items-center justify-between w-full bg-white rounded-lg cursor-pointer",children:a.jsxs("div",{className:"block relative",children:[a.jsx("input",{type:"checkbox",id:`react-option-${e.id}`,name:"complementos[]",className:"peer absolute top-3 left-3 w-5 h-5 accent-rosalasdonas border-[#FF8555] rounded-md peer-checked:accent-[#73B473]",required:!0,onChange:()=>i(e.id)}),e.images.length>0?e.images.map(r=>r.caratula===1?a.jsx("img",{className:"size-full w-48 h-56 rounded-lg object-cover",src:r.name_imagen?`/${r.name_imagen}`:"path/to/default.jpg",alt:e.producto},r.id):null):a.jsx("img",{className:"size-full w-48 h-56 rounded-lg object-cover",src:"/images/img/noimagen.jpg",alt:"No imagen"})]})}),a.jsx("h2",{className:"text-base font-normal text-black text-center",children:e.producto}),a.jsx("div",{className:"flex font-medium justify-center gap-4",children:e.descuento>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["S/ ",a.jsx("span",{children:e.descuento})]}),a.jsxs("p",{className:"line-through text-gray-400",children:["S/ ",a.jsx("span",{children:e.precio})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"S/ "}),a.jsx("span",{children:e.precio})]})})]},e.id))})},v=({datos:l,setDetallePedido:n})=>{const[s,o]=u.useState(null),[t,d]=u.useState([]),i=e=>{s===e?o(null):(o(e),t.includes(e)||d([...t,e]))};return a.jsx("div",{children:l.map((e,r)=>a.jsxs("div",{className:"mt-3",children:[a.jsx("h2",{id:`accordion-collapse-heading-${e.id}`,className:"gap-4 flex flex-col",children:a.jsxs("button",{className:`flex items-center justify-between w-full p-5 font-medium rounded-t-xl  dark:focus:ring-gray-800 dark:border-gray-700 dark:text-black hover:bg-gray-100 bg-[#F8F8F8] dark:hover:bg-gray-800 gap-3 ${s===r?"bg-[#FF8555] text-white":"text-black"}`,"data-accordion-target":`#accordion-collapse-body-${e.id}`,"aria-expanded":s===r,"aria-controls":`accordion-collapse-body-${e.id}`,type:"button",style:{transition:"all 500ms ease-in-out"},onClick:()=>i(r),children:[a.jsx("span",{children:e.name}),a.jsx("svg",{"data-accordion-icon":"",className:`w-3 h-3 shrink-0 ${s===r?"stroke-[#FF8555]":"rotate-180 text-[#FF8555]"} `,fill:"none",viewBox:"0 0 10 6",children:a.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5 5 1 1 5"})})]})}),a.jsx("div",{id:`accordion-collapse-body-${e.id}`,className:`${s===r?"":"hidden"}`,"aria-labelledby":`accordion-collapse-heading-${e.id}`,children:a.jsx("div",{className:"p-5 border border-gray-200 dark:border-gray-700 dark:bg-gray-900",children:t.includes(r)&&a.jsx(f,{id:e.id,setDetallePedido:n})})})]},e.id))})};export{v as A,x as a};
