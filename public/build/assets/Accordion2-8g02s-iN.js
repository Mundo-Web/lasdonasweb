import{j as a}from"./Example-zgwdEd5i.js";import{r as d}from"./useOutsideClick-TT1qJ6UJ.js";import{a as h}from"./axios-_sX4vCAy.js";import{s as m}from"./storage-zp2nPsZU.js";const f=async(c,u=!1)=>{try{const s=await h.post("/api/products/addComplemento",{id:c});if(s.status===200){const{data:i}=s.data;let n=i.map(t=>{var l;const p={id:t.id,producto:t.producto,precio:t.descuento>0?t.descuento:t.precio,imagen:((l=t.images.filter(x=>x.caratula===1)[0])==null?void 0:l.name_imagen)??"/images/img/noimagen.jpg",cantidad:1,sku:t.sku,tipo:"Complemento",fecha:"",horario:"",extract:t.extract};return t.tipo_servicio=="complemento"&&t.puntos_complemento>0&&(p.points=t.puntos_complemento,p.usePoints=u),p}),o=m.Local.get("carrito")??[];o.some(t=>t.id===n[0].id)?o=o.map(t=>t.id===n[0].id?{...t,cantidad:t.cantidad+Number(n[0].cantidad)}:t):o=[...o,n[0]],m.Local.set("carrito",o);const e=document.getElementById("open-cart"),r=$("#gift-icon");r.addClass("send-to-cart"),setTimeout(()=>{r.removeClass("send-to-cart"),r.removeAttr("style"),limpiarHTML(),PintarCarrito(),$(e).addClass("shake"),setTimeout(function(){$(e).removeClass("shake")},1e3)},1e3)}}catch(s){console.error(s),Swal.fire({icon:"error",title:"Error",text:"Hubo un error al agregar el pedido. Por favor, intÃ©ntelo de nuevo."})}},j=({id:c,setDetallePedido:u})=>{const[s,i]=d.useState([]),[n,o]=d.useState(!0);if(d.useEffect(()=>{(async()=>{try{const r=await h.post("/buscaSubComplementosDetalle",{id:c});i(r.data.productos),o(!1)}catch(r){console.error("Error fetching data:",r),o(!1)}})()},[c]),n)return a.jsx("div",{children:"Loading..."});const g=e=>{console.log(e),(Local.get("carrito")??[]).length>0?(console.log("entra porque tiene algo "),f(e)):u(t=>t.complementos.findIndex(l=>l===e)===-1?{...t,complementos:[...t.complementos,e]}:{...t,complementos:t.complementos.filter(l=>l!==e)})};return a.jsx("div",{className:"grid w-full gap-4 grid-cols-1 md:grid-cols-4 mt-6",children:s.map(e=>a.jsxs("div",{className:"m-auto",children:[a.jsx("label",{htmlFor:`react-option-${e.id}`,className:"inline-flex items-center justify-between w-full bg-white rounded-lg cursor-pointer",children:a.jsxs("div",{className:"block relative",children:[a.jsx("input",{type:"checkbox",id:`react-option-${e.id}`,name:"complementos[]",className:"peer absolute top-3 left-3 w-5 h-5 accent-rosalasdonas border-[#FF8555] rounded-md peer-checked:accent-[#73B473]",required:!0,onChange:()=>g(e.id)}),e.images.length>0?e.images.map(r=>r.caratula===1?a.jsx("img",{className:"size-full w-48 h-56 rounded-lg object-cover",src:r.name_imagen?`/${r.name_imagen}`:"path/to/default.jpg",alt:e.producto},r.id):null):a.jsx("img",{className:"size-full w-48 h-56 rounded-lg object-cover",src:"/images/img/noimagen.jpg",alt:"No imagen"})]})}),a.jsx("h2",{className:"text-base font-normal text-black text-center",children:e.producto}),a.jsx("div",{className:"flex font-medium justify-center gap-4",children:e.descuento>0?a.jsxs(a.Fragment,{children:[a.jsxs("p",{children:["S/ ",a.jsx("span",{children:e.descuento})]}),a.jsxs("p",{className:"line-through text-gray-400",children:["S/ ",a.jsx("span",{children:e.precio})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("p",{children:"S/ "}),a.jsx("span",{children:e.precio})]})})]},e.id))})},C=({datos:c,setDetallePedido:u})=>{const[s,i]=d.useState(null),[n,o]=d.useState([]),g=e=>{s===e?i(null):(i(e),n.includes(e)||o([...n,e]))};return d.useEffect(()=>{g(0)},[null]),a.jsx("div",{children:c.map((e,r)=>a.jsxs("div",{className:"mt-3",children:[a.jsx("h2",{id:`accordion-collapse-heading-${e.id}`,className:"gap-4 flex flex-col",children:a.jsxs("button",{className:`flex items-center justify-between w-full p-5 font-medium rounded-t-xl  dark:focus:ring-gray-800 dark:border-gray-700 dark:text-black hover:bg-gray-100 bg-[#F8F8F8] dark:hover:bg-gray-800 gap-3 ${s===r?"bg-[#FF8555] text-white":"text-black rounded-b-xl"}`,"data-accordion-target":`#accordion-collapse-body-${e.id}`,"aria-expanded":s===r,"aria-controls":`accordion-collapse-body-${e.id}`,type:"button",style:{transition:"all 500ms ease-in-out"},onClick:()=>g(r),children:[a.jsx("span",{children:e.name}),a.jsx("svg",{"data-accordion-icon":"",className:`w-3 h-3 shrink-0 ${s===r?"stroke-[#FF8555]":"rotate-180 text-[#FF8555]"} `,fill:"none",viewBox:"0 0 10 6",children:a.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5 5 1 1 5"})})]})}),a.jsx("div",{id:`accordion-collapse-body-${e.id}`,className:`${s===r?"":"hidden"}`,"aria-labelledby":`accordion-collapse-heading-${e.id}`,children:a.jsx("div",{className:"p-5 border border-gray-200 dark:border-gray-700 dark:bg-gray-900 rounded-b-xl",children:n.includes(r)&&a.jsx(j,{id:e.id,setDetallePedido:u})})})]},e.id))})};export{C as A,f as a};
